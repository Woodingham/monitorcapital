<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MONITOR DE CAPITAL | V26.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/2454/2454282.png" type="image/png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Playfair+Display:wght@700;900&family=JetBrains+Mono:wght@500;800&display=swap');
        :root { --paper: #fdfcf9; --ink: #1a1a1a; }
        body { background-color: #efede8; font-family: 'Lora', serif; color: var(--ink); padding: 10px; }
        .newspaper-container { background-color: var(--paper); max-width: 1200px; margin: 0 auto; padding: 30px; border: 1px solid #d1d1d1; box-shadow: 10px 10px 0px rgba(0,0,0,0.05); min-height: 100vh; }
        h1 { font-family: 'Playfair Display', serif; font-size: 4rem !important; line-height: 1.1; text-transform: uppercase; letter-spacing: -2px; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .double-line { border-top: 6px double var(--ink); border-bottom: 2px solid var(--ink); }
        nav button { font-family: 'JetBrains Mono', monospace; font-size: 13px; font-weight: bold; padding: 10px; border-bottom: 3px solid transparent; transition: 0.3s; }
        nav button.active { border-bottom: 3px solid var(--ink); background: rgba(0,0,0,0.05); }
        .view { display: none; }
        .view.active { display: block; }
        .divisa-card { border: 2px solid var(--ink); padding: 1.5rem; text-align: center; background: white; }
        .ganadora { border: 3px solid #10b981 !important; background: #f0fdf4; transform: scale(1.02); position: relative; }
        .ganadora::after { content: '★ MÁXIMA RENTABILIDAD'; position: absolute; top: -12px; right: 15px; background: #10b981; color: white; font-family: 'JetBrains Mono'; font-size: 10px; padding: 4px 8px; font-weight: 800; border-radius: 3px; }
        .chart-container { position: relative; height: 400px; width: 100%; }
    </style>
</head>
<body>

<div class="newspaper-container">
    <header class="text-center mb-10">
        <div class="flex justify-between items-end mb-4 mono font-bold text-[11px]">
            <span id="fecha-header">09/01/2026</span>
            <span id="status-badge" class="bg-amber-100 px-3 py-1 text-amber-800 uppercase tracking-tighter">Conectando con Endpoints...</span>
        </div>
        <div class="double-line py-8">
            <h1 class="font-black">MONITOR DE CAPITAL</h1>
            <p class="text-xl md:text-2xl font-medium text-stone-600 tracking-widest mt-2 uppercase">Terminal Técnica de Activos Argentinos</p>
        </div>
        <nav class="flex flex-wrap justify-center gap-2 md:gap-4 border-b border-black/10 mt-6 overflow-x-auto pb-2">
            <button onclick="switchView('portada')" id="btn-portada" class="active uppercase">Ranking</button>
            <button onclick="switchView('divisas')" id="btn-divisas" class="uppercase">Monedas</button>
            <button onclick="switchView('crypto')" id="btn-crypto" class="uppercase">Cripto</button>
            <button onclick="switchView('historico')" id="btn-historico" class="uppercase">Gráfico</button>
            <button onclick="switchView('calculos')" id="btn-calculos" class="uppercase">Simuladores</button>
            <button onclick="switchView('estrategias')" id="btn-estrategias" class="uppercase">Análisis</button>
            <button onclick="switchView('glosario')" id="btn-glosario" class="uppercase">Glosario</button>
        </nav>
    </header>

    <div id="view-portada" class="view active">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
            <main class="lg:col-span-8">
                <h3 class="font-black border-b-2 border-black inline-block mb-8 text-stone-500 text-lg uppercase">Instrumentos de Tasa Fija</h3>
                <div id="cont-tasas" class="space-y-6"></div>
            </main>
            <aside class="lg:col-span-4 border-l-2 border-black/10 pl-8">
                <div class="bg-stone-100 p-6 border-2 border-black/10 mb-6">
                    <h4 class="font-black text-xs uppercase mb-4 text-emerald-900 tracking-widest">Dólar MEP (Referencia)</h4>
                    <p class="text-5xl mb-4 font-bold tracking-tighter" id="val-mep-side">--</p>
                    <p class="text-sm border-t border-black/10 pt-4">Brecha: <span id="brecha-val" class="font-bold">--</span></p>
                    <p class="text-sm">Inflación (IPC): <span class="font-bold text-rose-700">2.7% m/m</span></p>
                </div>
            </aside>
        </div>
    </div>

    <div id="view-divisas" class="view">
        <h3 class="font-black border-b-2 border-black inline-block mb-8 text-stone-500 text-lg uppercase">Mercado Cambiario</h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6" id="cont-divisas"></div>
    </div>

    <div id="view-crypto" class="view">
        <h3 class="font-black border-b-2 border-black inline-block mb-8 text-stone-500 text-lg uppercase">Dólar Digital y Activos</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8" id="cont-crypto-main"></div>
    </div>

    <div id="view-historico" class="view">
        <h3 class="font-black border-b-2 border-black inline-block mb-8 text-stone-500 text-lg uppercase">Gráfico de Correlación</h3>
        <div class="bg-white p-6 border-2 border-black shadow-sm">
            <div class="chart-container"><canvas id="chartHistorico"></canvas></div>
        </div>
    </div>

    <div id="view-calculos" class="view">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
            <div class="p-8 border-4 border-black bg-white">
                <h4 class="font-black mb-4 uppercase text-sm">Simulador de Plazo Fijo/Lecaps</h4>
                <input type="number" id="inputCapital" placeholder="Capital en Pesos" class="w-full text-4xl font-bold mb-4 p-3 border-b-4 border-black outline-none bg-stone-50">
                <p class="text-xs uppercase font-bold opacity-50 mb-1">Interés Estimado (30 días)</p>
                <p id="resCalculo" class="mono text-5xl font-black text-emerald-900">$ 0</p>
            </div>
            <div class="p-8 border-4 border-black bg-stone-900 text-white shadow-[10px_10px_0px_rgba(0,0,0,0.1)]">
                <h4 class="font-black mb-4 uppercase text-sm">Ajuste de Contratos</h4>
                <input type="number" id="inputAlq" class="w-full bg-transparent text-white text-4xl font-bold mb-4 border-b-4 border-stone-600 outline-none" placeholder="Monto">
                <select id="selectAlq" onchange="handleAlqChange()" class="w-full bg-stone-800 text-white p-3 mb-4 font-bold">
                    <option value="0.15">Trimestral (+15%)</option>
                    <option value="0.30">Cuatrimestral (+30%)</option>
                    <option value="0.45">Semestral (+45%)</option>
                    <option value="custom">Manual %</option>
                </select>
                <input type="number" id="inputCustomPct" class="hidden w-full text-black p-3 mb-4" placeholder="Ej: 22">
                <p id="resAlq" class="mono text-4xl font-black text-indigo-400">$ 0</p>
            </div>
        </div>
    </div>

    <div id="view-estrategias" class="view">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
            <div class="border-l-8 border-black pl-8">
                <h3 class="font-black text-2xl mb-4 uppercase">Análisis Técnico: Carry Trade</h3>
                <p class="text-lg leading-relaxed mb-4 text-stone-700">Con una tasa de Lecaps que supera la inflación proyectada, el inversor minorista puede capturar rendimientos reales positivos. El riesgo principal reside en la unificación cambiaria, que podría generar un salto en el MEP, licuando la ganancia de tasa acumulada.</p>
            </div>
            <div class="border-l-8 border-emerald-500 pl-8">
                <h3 class="font-black text-2xl mb-4 uppercase">Estrategia de Liquidez</h3>
                <p class="text-lg leading-relaxed text-stone-700">Para perfiles conservadores, las cauciones bursátiles siguen siendo la mejor opción para el dinero transaccional. Para el mediano plazo (90 días), los bonos ajustados por CER ofrecen protección ante una eventual aceleración de precios.</p>
            </div>
        </div>
    </div>

    <div id="view-glosario" class="view">
        <h3 class="font-black border-b-2 border-black inline-block mb-8 text-stone-500 text-lg uppercase">Glosario de la Terminal</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="cont-glosario"></div>
    </div>

    <footer class="mt-16 pt-6 border-t-2 border-black flex flex-wrap justify-between mono text-[10px] font-bold opacity-60">
        <span id="update-info">INICIANDO...</span>
        <span class="uppercase">Terminal v26.0 | Endpoints: DolarAPI & ArgentinaDatos</span>
    </footer>
</div>

<script>
    // ESTADO GLOBAL DE LA APP
    let FINANZAS = { 
        mep: 1450, blue: 1480, oficial: 980, cripto: 1490, tarjeta: 1560,
        tasas: [
            { nombre: "Plazo Fijo", valor: 35.0, desc: "Tasa bancaria estandarizada." },
            { nombre: "Lecaps", valor: 43.5, desc: "Letras capitalizables del Tesoro." },
            { nombre: "Caución", valor: 31.8, desc: "Tasa bursátil de corto plazo." },
            { nombre: "Billeteras", valor: 30.2, desc: "Promedio de cuentas remuneradas." }
        ]
    };

    const GLOSARIO = [
        { t: "Arbitraje", d: "Ganancia inmediata por diferencia de precios entre dos mercados." },
        { t: "Brecha", d: "Diferencia porcentual entre el dólar oficial y el dólar MEP/CCL." },
        { t: "CER", d: "Coeficiente que ajusta el capital de un bono según la inflación." },
        { t: "Dólar MEP", d: "Dólar que se obtiene mediante la compra y venta de bonos (AL30)." },
        { t: "TEA", d: "Tasa Efectiva Anual: rendimiento real considerando la reinversión mensual." },
        { t: "Spread", d: "Diferencia entre el precio de compra y el precio de venta." },
        { t: "USDT", d: "Tether. Criptomoneda estable que mantiene paridad 1:1 con el dólar." }
    ];

    // MOTOR AUTÓNOMO DE DATOS
    async function sync() {
        const badge = document.getElementById('status-badge');
        const PROXY = "https://api.allorigins.win/raw?url=";
        const ts = Date.now();
        
        console.log("Reintentando conexión automática...");
        badge.innerText = "ACTUALIZANDO...";
        badge.className = "bg-sky-100 px-3 py-1 text-sky-800 uppercase font-bold text-[10px] animate-pulse";

        const fetchData = async (url) => {
            try {
                // Intento 1: Directo con rompe-cache
                const res = await fetch(`${url}?t=${ts}`);
                if (res.ok) return await res.json();
            } catch (e) {
                // Intento 2: Proxy
                try {
                    const resP = await fetch(PROXY + encodeURIComponent(`${url}?t=${ts}`));
                    if (resP.ok) return await resP.json();
                } catch (e2) { return null; }
            }
            return null;
        };

        try {
            const dataD = await fetchData("https://dolarapi.com/v1/dolares");
            if (dataD) {
                dataD.forEach(d => {
                    if (d.casa === "mep") FINANZAS.mep = d.venta;
                    if (d.casa === "blue") FINANZAS.blue = d.venta;
                    if (d.casa === "oficial") FINANZAS.oficial = d.venta;
                    if (d.casa === "cripto") FINANZAS.cripto = d.venta;
                });
                localStorage.setItem('monitor_cache', JSON.stringify(FINANZAS));
                badge.innerText = "ONLINE";
                badge.className = "bg-emerald-500 text-white px-3 py-1 text-[10px] font-bold rounded";
                
                // Si tuvo éxito, reintenta en 5 minutos
                setTimeout(sync, 300000); 
            } else {
                throw new Error("Sin respuesta");
            }
        } catch (error) {
            // Si falló, usa cache y reintenta RÁPIDO (en 30 segundos)
            const cache = localStorage.getItem('monitor_cache');
            if (cache) FINANZAS = JSON.parse(cache);
            
            badge.innerText = "REINTENTANDO CONEXIÓN...";
            badge.className = "bg-amber-500 text-white px-3 py-1 text-[10px] font-bold rounded";
            
            setTimeout(sync, 30000); 
        }

        render();
        if(typeof initChart === 'function') initChart();
    }

    // INICIO ÚNICO
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('fecha-header').innerText = new Date().toLocaleDateString();
        // Disparar la primera vez
        sync(); 
        
        // El resto de los eventos (inputs) se mantienen igual
        document.getElementById('inputCapital').oninput = () => {
            const v = parseFloat(document.getElementById('inputCapital').value) || 0;
            const t = Math.max(...FINANZAS.tasas.map(x => x.valor));
            document.getElementById('resCalculo').innerText = fmt((v * (t/100) * 30) / 365);
        };
        document.getElementById('inputAlq').oninput = updateAlq;
        document.getElementById('inputCustomPct').oninput = updateAlq;
    });
    // MOTOR DE RENDERIZADO
    function render() {
        // Render Ranking Ordenado
        const contT = document.getElementById('cont-tasas');
        contT.innerHTML = '';
        const sorted = [...FINANZAS.tasas].sort((a,b) => b.valor - a.valor);
        sorted.forEach((t, i) => {
            contT.innerHTML += `
            <div class="p-8 flex justify-between items-center bg-white border-2 border-black ${i === 0 ? 'ganadora' : ''}">
                <div>
                    <p class="font-black text-2xl uppercase tracking-tighter">${t.nombre}</p>
                    <p class="text-sm opacity-60">${t.desc}</p>
                </div>
                <div class="text-right">
                    <p class="text-5xl font-black mono">${t.valor.toFixed(1)}%</p>
                    <p class="text-[10px] font-bold opacity-40 uppercase">Tasa Nominal Anual</p>
                </div>
            </div>`;
        });

        // Render Lateral y Divisas
        document.getElementById('val-mep-side').innerText = "$" + FINANZAS.mep;
        document.getElementById('brecha-val').innerText = ((FINANZAS.mep/FINANZAS.oficial - 1)*100).toFixed(1) + "%";

        document.getElementById('cont-divisas').innerHTML = `
            <div class="divisa-card"><span class="mono text-xs opacity-50 uppercase">Blue</span><p class="text-4xl font-black">$${FINANZAS.blue}</p></div>
            <div class="divisa-card"><span class="mono text-xs opacity-50 uppercase">Mep</span><p class="text-4xl font-black">$${FINANZAS.mep}</p></div>
            <div class="divisa-card"><span class="mono text-xs opacity-50 uppercase">Oficial</span><p class="text-4xl font-black">$${FINANZAS.oficial}</p></div>
            <div class="divisa-card"><span class="mono text-xs opacity-50 uppercase">Tarjeta</span><p class="text-4xl font-black">$${FINANZAS.tarjeta}</p></div>
        `;

        // Render Crypto
        document.getElementById('cont-crypto-main').innerHTML = `
            <div class="divisa-card bg-indigo-50 border-indigo-400"><span class="mono text-xs opacity-50 uppercase">Dólar Cripto (USDT)</span><p class="text-4xl font-black">$${FINANZAS.cripto}</p></div>
            <div class="divisa-card bg-amber-50 border-amber-400"><span class="mono text-xs opacity-50 uppercase">Bitcoin (BTC)</span><p class="text-4xl font-black">$96,400</p></div>
            <div class="divisa-card bg-blue-50 border-blue-400"><span class="mono text-xs opacity-50 uppercase">Ethereum (ETH)</span><p class="text-4xl font-black">$2,410</p></div>
        `;

        // Render Glosario
        const contG = document.getElementById('cont-glosario');
        contG.innerHTML = '';
        GLOSARIO.forEach(item => {
            contG.innerHTML += `<div class="border-l-4 border-black pl-4 mb-6"><h5 class="font-black uppercase text-sm mb-1">${item.t}</h5><p class="text-xs italic leading-snug">${item.d}</p></div>`;
        });

        document.getElementById('update-info').innerText = "SINC: " + new Date().toLocaleTimeString();
    }

    // NAVEGACIÓN
    function switchView(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        document.getElementById('view-' + id).classList.add('active');
        document.getElementById('btn-' + id).classList.add('active');
    }

    // LÓGICA DE GRÁFICOS
    function initChart() {
        const ctx = document.getElementById('chartHistorico').getContext('2d');
        if(window.myChart) window.myChart.destroy();
        window.myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ["Día 1", "Día 7", "Día 15", "Día 22", "Hoy"],
                datasets: [{
                    label: 'Dólar MEP ($)',
                    data: [1390, 1420, 1405, 1440, FINANZAS.mep],
                    borderColor: '#1a1a1a', borderWidth: 4, pointRadius: 5, fill: false, yAxisID: 'y'
                }, {
                    label: 'TNA (%)',
                    data: [38, 37, 36.5, 35.5, FINANZAS.tasas[0].valor],
                    borderColor: '#10b981', borderDash: [5, 5], yAxisID: 'y1'
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, scales: { y: { position: 'left' }, y1: { position: 'right', grid: { display: false } } } }
        });
    }

    // SIMULADORES
    function handleAlqChange() {
        const sel = document.getElementById('selectAlq').value;
        document.getElementById('inputCustomPct').classList.toggle('hidden', sel !== 'custom');
        updateAlq();
    }
    function updateAlq() {
        const val = parseFloat(document.getElementById('inputAlq').value) || 0;
        const sel = document.getElementById('selectAlq').value;
        let pct = (sel === 'custom') ? (parseFloat(document.getElementById('inputCustomPct').value) || 0)/100 : parseFloat(sel);
        document.getElementById('resAlq').innerText = new Intl.NumberFormat('es-AR', { style: 'currency', currency: 'ARS' }).format(val * (1 + pct));
    }

    // INICIO
    document.addEventListener('DOMContentLoaded', () => {
        sync();
        document.getElementById('inputCapital').oninput = () => {
            const v = parseFloat(document.getElementById('inputCapital').value) || 0;
            const tMax = Math.max(...FINANZAS.tasas.map(t => t.valor));
            const ganancia = (v * (tMax/100) * 30) / 365;
            document.getElementById('resCalculo').innerText = new Intl.NumberFormat('es-AR', { style: 'currency', currency: 'ARS' }).format(ganancia);
        };
        document.getElementById('inputAlq').oninput = updateAlq;
        document.getElementById('inputCustomPct').oninput = updateAlq;
    });
</script>
</body>

</html>



